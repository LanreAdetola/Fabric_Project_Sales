{"name":"Dataflow 3_Customers","ppdf:dataflowId":"5e63180d-6b07-414c-a481-78d71f191588","ppdf:owner":{"tenantId":"77d33cc5-c9b4-4766-95c7-ed5b515e1cce","userId":"b1d974c0-a2a6-4f45-a112-6c7facea553f"},"ppdf:fastCopy":true,"version":"1.0","culture":"en-GB","modifiedTime":"2025-04-27T19:55:46.5275281+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"DefaultDestination":{"queryId":"b564baf5-bbca-4568-93dd-82f77f84d435","queryName":"DefaultDestination"},"wwi_customers":{"queryId":"68da5daa-c8f5-4d90-b038-24cf2ccc5445","queryName":"wwi_customers"},"wwi_customers_DataDestination":{"queryId":"e9c0669d-f27c-4702-b9df-46233805c836","queryName":"wwi_customers_DataDestination"},"wwi_customers_WriteToDataDestination":{"queryId":"ab839e07-7226-46a0-aa6b-b858aa16580b","queryName":"wwi_customers_WriteToDataDestination"},"wwi_customers_TransformForWriteToDataDestination":{"queryId":"9d8aabf5-d741-4e3a-b809-514dd39a7add","queryName":"wwi_customers_TransformForWriteToDataDestination"},"FastCopyStaging":{"queryId":"798054ca-8635-4c9a-a835-f31cc6d1968b","queryName":"FastCopyStaging"}},"document":"section Section1;\r\nshared DefaultDestination = let\r\n  DefaultDestination = Lakehouse.Contents([EnableFolding = false]){[workspaceId = \"9498f6af-d563-4a1a-a2c3-961e48cc7b47\"]}[Data]{[lakehouseId = \"7b76e446-58c3-4384-965c-fb04519a4dc9\"]}[Data]\r\nin\r\n  DefaultDestination;\r\nshared wwi_customers = let\r\n  Source = Excel.Workbook(Web.Contents(\"https://thomasmore365-my.sharepoint.com/personal/r0913836_student_thomasmore_be/Documents/Apps/Microsoft Power Query/Uploaded Files/WWI_Customers.xlsx\"), null, true),\r\n  #\"Navigation 1\" = Source{[Item = \"sheet1\", Kind = \"Sheet\"]}[Data],\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Navigation 1\", {{\"Column1\", type text}, {\"Column2\", type text}, {\"Column3\", type text}, {\"Column4\", type text}, {\"Column5\", type text}, {\"Column6\", type text}, {\"Column7\", type text}, {\"Column8\", type text}, {\"Column9\", type text}, {\"Column10\", type text}, {\"Column11\", type text}}),\r\n  #\"Removed columns\" = Table.RemoveColumns(#\"Changed column type\", {\"Column7\", \"Column10\", \"Column11\"}),\r\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Removed columns\", [PromoteAllScalars = true]),\r\n  #\"Removed columns 1\" = Table.RemoveColumns(#\"Promoted headers\", {\"PostalCode\"})\r\nin\r\n  #\"Removed columns 1\";\r\nshared wwi_customers_DataDestination = let\r\n  Pattern = Lakehouse.Contents([CreateNavigationProperties = false, EnableFolding = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"9498f6af-d563-4a1a-a2c3-961e48cc7b47\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"7b76e446-58c3-4384-965c-fb04519a4dc9\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"wwi_customers\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[CustomerID = nullable Text.Type, CompanyName = nullable Text.Type, ContactName = nullable Text.Type, ContactTitle = nullable Text.Type, Address = nullable Text.Type, City = nullable Text.Type, Country = nullable Text.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\n[Staging = \"FastCopyStaging\"]\r\nshared wwi_customers_WriteToDataDestination = let\r\n  wwi_customers_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = wwi_customers_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], wwi_customers_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  wwi_customers_WriteToDataDestination;\r\nshared wwi_customers_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(wwi_customers, {\"CustomerID\", \"CompanyName\", \"ContactName\", \"ContactTitle\", \"Address\", \"City\", \"Country\"})\r\nin\r\n    SourceTable;\r\nshared FastCopyStaging = let\r\n  FastCopyStaging = Pipeline.FastCopyModelStorage(DefaultStaging, [Required = false])\r\nin\r\n  FastCopyStaging;\r\n","connectionOverrides":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null},{"path":"https://thomasmore365-my.sharepoint.com/personal/r0913836_student_thomasmore_be/","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://thomasmore365-my.sharepoint.com/personal/r0913836_student_thomasmore_be/\"}","audience":null}]}}